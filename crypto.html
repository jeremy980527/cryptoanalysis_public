<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å¯†è²¨å¹£è¶¨å‹¢ç›£æ§</title>
    <style>
        /* æ·±è‰²ä¸»é¡Œæ¨£å¼ */
        body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #121212; color: #e0e0e0; }
        h1 { text-align: center; color: #fff; margin-bottom: 5px; text-shadow: 0 0 10px rgba(33, 150, 243, 0.5); }
        .subtitle { text-align: center; color: #888; font-size: 0.9em; margin-bottom: 30px; }
        
        .status-bar { text-align: right; margin-bottom: 15px; font-size: 0.8em; color: #666; display: flex; align-items: center; justify-content: flex-end; gap: 8px;}
        .dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: #444; }
        .dot.green { background: #4CAF50; box-shadow: 0 0 5px #4CAF50; }
        .dot.red { background: #F44336; box-shadow: 0 0 5px #F44336; }
        .dot.orange { background: #FF9800; box-shadow: 0 0 5px #FF9800; }
        
        .section { margin-bottom: 25px; background: #1e1e1e; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); border: 1px solid #333; }
        .section h3 { margin-top: 0; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        
        .section.bull { border-left: 5px solid #4CAF50; }
        .section.bull h3 { color: #4CAF50; border-color: #4CAF50; }
        
        .section.bear { border-left: 5px solid #F44336; }
        .section.bear h3 { color: #F44336; border-color: #F44336; }
        
        .section.neut { border-left: 5px solid #2196F3; }
        .section.neut h3 { color: #2196F3; border-color: #2196F3; }

        ul { list-style: none; padding: 0; margin: 0; }
        li { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #2a2a2a; transition: all 0.2s; border-radius: 8px; margin-bottom: 5px; background: #252525; }
        li:hover { transform: translateY(-2px); background: #2f2f2f; }
        
        .coin-name { font-weight: bold; font-size: 1.2em; color: #fff; letter-spacing: 1px; }
        
        .badges { display: flex; gap: 8px; align-items: center; }
        .badge { padding: 5px 10px; border-radius: 6px; font-size: 0.85em; font-weight: 500; }
        
        .score-badge { background: #333; color: #fff; border: 1px solid #555; }
        .msg-badge { background: #1a1a1a; border: 1px solid #444; color: #aaa; }
        
        .fire { color: #ff9800; font-weight: bold; }

        .empty-msg { color: #555; font-style: italic; text-align: center; padding: 20px; }
        .loading { text-align: center; padding: 40px; color: #666; font-style: italic; }
        
        .footer { text-align: center; margin-top: 40px; color: #444; font-size: 0.8em; }
    </style>
</head>
<body>

    <h1>å¸‚å ´ç•°å¸¸ç›£æ§çœ‹æ¿</h1>
    <div class="subtitle">Real-time Crypto Anomaly Monitor</div>

    <div class="status-bar">
        <span id="dot" class="dot"></span>
        <span id="statusText">æ­£åœ¨é€£ç·šè‡³æ•¸æ“šä¸­å¿ƒ...</span>
    </div>

    <div id="content">
        <div class="loading">æ­£åœ¨ç­‰å¾…ä¼ºæœå™¨å›å‚³åˆ†æçµæœ...<br>(è«‹ç¨å€™ï¼Œé¦–æ¬¡è¼‰å…¥å¯èƒ½éœ€è¦å¹¾ç§’é˜)</div>
    </div>

    <div class="footer">Data provided by BotVsing Analysis Core</div>

    <script>
        // ã€é‡è¦ã€‘è«‹å°‡ä¸‹æ–¹ç¶²å€æ›æˆä½  Ngrok ç”¢ç”Ÿçš„æœ€æ–°ç¶²å€
        const API_URL = "https://tunefully-abstemious-shu.ngrok-free.dev -> http://localhost:8000";

        async function updateDashboard() {
            const statusText = document.getElementById('statusText');
            const dot = document.getElementById('dot');
            const content = document.getElementById('content');
            
            try {
                // åŠ ä¸Šæ™‚é–“æˆ³è¨˜é˜²æ­¢å¿«å–ï¼Œä¸¦åŠ å…¥é€šé—œå¯†èª Header
                const res = await fetch(`${API_URL}?t=${new Date().getTime()}`, {
                    headers: new Headers({
                        "ngrok-skip-browser-warning": "true",
                    }),
                });

                const json = await res.json();
                
                if (json.status === 'success') {
                    statusText.innerText = `æœ€å¾Œæ›´æ–°: ${json.timestamp}`;
                    dot.className = 'dot green';
                    renderLists(json.data);
                } else if (json.status === 'waiting') {
                    statusText.innerText = 'ä¼ºæœå™¨æ­£åœ¨çˆ¬å–é‹ç®—ä¸­...';
                    dot.className = 'dot orange';
                } else {
                    statusText.innerText = 'ä¼ºæœå™¨ç™¼ç”Ÿå…§éƒ¨éŒ¯èª¤';
                    dot.className = 'dot red';
                }
            } catch (e) {
                console.error(e);
                statusText.innerText = 'ç„¡æ³•é€£ç·š (è«‹ç¢ºèªé›»è…¦ç«¯ Server èˆ‡ Ngrok æ˜¯å¦é–‹å•Ÿ)';
                dot.className = 'dot red';
            }
        }

        function renderLists(data) {
            const container = document.getElementById('content');
            container.innerHTML = ''; 

            const createSection = (title, list, typeClass, icon) => {
                const sec = document.createElement('div');
                sec.className = `section ${typeClass}`;
                
                let listHtml = '';
                if (list.length === 0) {
                    listHtml = '<div class="empty-msg">ç›®å‰ç„¡ç¬¦åˆæ¢ä»¶å¹£ç¨®</div>';
                } else {
                    listHtml = '<ul>' + list.map(item => {
                        let displayMsg = item.msg;
                        if(displayMsg.includes('çˆ†é‡')) {
                            displayMsg = displayMsg.replace('çˆ†é‡', '<span class="fire">ğŸ”¥çˆ†é‡</span>');
                        }
                        return `
                        <li>
                            <span class="coin-name">${item.name}</span>
                            <div class="badges">
                                <span class="badge msg-badge">${displayMsg}</span>
                                <span class="badge score-badge">ç¶œåˆåˆ†æ•¸ ${item.score}%</span>
                            </div>
                        </li>
                    `}).join('') + '</ul>';
                }

                sec.innerHTML = `<h3>${icon} ${title}</h3>${listHtml}`;
                return sec;
            };

            container.appendChild(createSection('å¤šé ­ç•°å¸¸ (Bullish)', data.bull, 'bull', 'ğŸš€'));
            container.appendChild(createSection('ç©ºé ­ç•°å¸¸ (Bearish)', data.bear, 'bear', 'ğŸ“‰'));
            container.appendChild(createSection('ç­‰å¾…çªç ´ (Neutral)', data.neut, 'neut', 'âš–ï¸'));
        }

        // å•Ÿå‹•è‡ªå‹•æ›´æ–° (æ¯ 10 ç§’)
        updateDashboard();
        setInterval(updateDashboard, 10000); 
    </script>
</body>
</html>
